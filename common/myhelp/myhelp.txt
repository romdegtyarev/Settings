КОМАНДЫ:
Основные Linux команды:
----------
ls                                               Вывод содержимого текущей
                                                 дириктории
lsblk                                            Вывод списка блочных устройств
df                                               Вывод списка файловых систем
mount /dev/sda1 /mnt/                            Монтирование /dev/sda1 в /mnt/
umount /dev/sda1                                 Отмонтирование /dev/sda1
lsusb                                            Вывод списка USB
lsipc                                            Вывод информации об объектах
                                                 IPC, которые в настоящее время
                                                 используются системой
ipcs                                             Вывод информации
                                                 об объектах IPC
lsof                                             Вывод списка открытых файлов
htop                                             Вывод списка всех запущенных
                                                 процессов
ps ax                                            Вывод списка всех запущенных
                                                 процессов
kill proc                                        Остановка процесса
                                                 с номером proc
jobs -l                                          Вывод состояния всех
                                                 остановленных и выполняемых в
                                                 фоновом режиме задач
fg                                               Возващение процесса из
                                                 фонового режима
echo 0 > /proc/sys/kernel/printk                 Отключение сообщений ядра
----------

Работа с файлами:
----------
pwd                                              Вывод пути до текущей
                                                 дириктории
cd                                               Смена дириктории
mkdir dir                                        Создание директории dir
rmdir dir                                        Удаление директории dir
touch file                                       Создание файла file
cp src dst                                       Копирование
rm file/dir                                      Удаление файлов/директорий
rm -r                                            Удаление рекурсивное
rm -f                                            Удаление без подтверждения
ln -s src dst                                    Создание ссылки
chmod                                            Смена прав доступа
                                                 (Владелец, Группа, Остальные
                                                 (Чтение, Запись, Выполнение))
chown -R group:name                              Смена владельца
script                                           Запись сеанса терминала
alias newName='Comand'                           Создание псевдонима команды
----------

Работа со строками:
----------
cat                                              Объединение и распечатка файла
echo "String"                                    Вывод String на
                                                 стандартный вывод
echo "String" > ./file                           Запись в file String
echo "String" >> ./file                          Дозапись в file String
tr                                               Редактор строк
sed                                              Редактор строк
awk                                              Редактор строк
grep string file                                 Поиск строк string в file
grep -r string ./                                Поиск рекурсивный строк string
                                                 во всех файлах находящихся в ./
grep -i                                          Флаг игнорирования регистра
grep -с                                          Флаг вывода количества
                                                 найденых строк
grep -n                                          Флаг вывода номеров найденных
                                                 строк
grep -v                                          Флаг для вывода строк если они
                                                 не найдены
find / -name 'name'                              Поиск файлов в / по имени name
find -type f/d/l/p/s                             Поиск файлов по типу
find -exec command {} \;                         Поиск и выполнение действия
                                                 command над найдеными
----------

Сеть:
----------
ip a                                             Показать информацию
                                                 об интерфейсах
ifconfig                                         Показать информацию
                                                 об интерфейсах
ip route show                                    Вывод маршрутов
ip add *.*.*.*/* via *.*.*.*                     Добавление маршрута
ip del *.*.*.*/* via *.*.*.*                     Удаление маршрута
ip addr add *.*.*.*/* dev eth0                   Добавление IP
ip addr del *.*.*.*/* dev eth0                   Удаление IP
sudo ip link set mtu 9000 dev eth0               Задание значения MTU 9000
                                                 на интерфейсе eth0
vconfig add eth0 20                              Создание 20 VLAN на интерфейсе
                                                 eth0
arp -a                                           Вывод arp таблицы
netstat -a                                       Вывод состояния всех сокетов
netstat -r                                       Вывод маршрутов
whois                                            Вывод информации о домене
                                                 или IP адресе
nslookup                                         Вывод информации о домене
nmap                                             Сканирование сети
ifconfig eth0.20 hw ether 60:e3:27:00:d7:36      Изменить MAC на интерфейсе
                                                 eth0.20 на 60:e3:27:00:d7:36
route                                            Вывод маршрутов
ping                                             Проверка целостности и
                                                 качества соединений
traceroute                                       Определение маршрутов
                                                 следования данных
sudo wg-quick up wg0                             Поднять интерфейс
sudo wg-quick down wg0                           Опустить интерфейс
sudo wg show                                     Показать информацию
sudo iptables -t mangle-A OUTPUT -j DSCP --set-dscp 31
                                                 Установка DSCP
tcpdump -i eth0                                  Захват данных с интерфейса eth0
----------
Опции tcpdump:
----------
-i                                               Интерфейс, с которого
                                                 необходимо анализировать трафик
-n                                               Отключение преобразования IP в
                                                 доменные имена
-e                                               Вывод данных
                                                 канального уровня
-v                                               Вывод дополнительной информации
-s                                               Установка размера захватываемых
                                                 пакетов
-w file_name                                     Задать имя файла, в который
                                                 сохранять собранную информацию
-r file_name                                     Чтение дампа из
                                                 заданного файла
-p                                               Захват только трафика, который
                                                 предназначен данному узлу
                                                 (по умолчанию - захват всех
                                                 пакетов)
-q                                               Перевод tcpdump в "бесшумный
                                                 режим", пакет анализируется на
                                                 транспортном уровне
-t                                               Отключение вывода меток времени
----------
Фильтрующие параметры tcpdump:
----------
dst host                                         Проверяет, совпадает ли адрес
                                                 получателя IP-пакета с
                                                 указанным значением
                                                 Возможно задавать как IP,
                                                 подсеть в формате 10.0.0.1/24,
                                                 так и имя хоста
src host                                         Проверяет, совпадает ли адрес
                                                 отправителя IP пакета с
                                                 указанным значением
                                                 Возможно задавать как IP,
                                                 подсеть в формате 10.0.0.1/24,
                                                 так и имя хоста
host host                                        Проверяет, совпадает ли адрес
                                                 отправителя или получателя с
                                                 заданным значением
                                                 Возможно задавать как IP,
                                                 подсеть в формате 10.0.0.1/24,
                                                 так и имя хоста
net net_name                                     Проверяется, находится ли адрес
                                                 отправителя/получателя в
                                                 заданной сети
ip | arp | rarp | tcp | udp | icmp [хост]        Проверяет, принадлежит ли пакет
                                                 одному из указанных протоколов
                                                 и при указании адреса хоста
                                                 проверяет, совпадает ли адрес
                                                 отправителя/получателя
                                                 с заданным
[tcp | udp] dst port port_num                    Проверяет, принадлежит ли
                                                 пакет протоколу TCP/UDP и равен
                                                 ли порт назначения заданному
[tcp | udp] src port port_num                    Проверяет, принадлежит ли
                                                 пакет протоколу TCP/UDP и равен
                                                 ли порт источника заданному
[tcp | udp] port port_num                        Проверяет, принадлежит ли
                                                 пакет протоколу TCP/UDP и равен
                                                 ли порт назначения или
                                                 источника заданному
ether { src | dst | host } MAC                   Проверяет, принадлежит ли
                                                 сетевой пакет источнику,
                                                 назначению, источнику или
                                                 назначению имеющему заданный
                                                 MAC
ip broadcast                                     Проверяет, является ли
                                                 IP пакет широковещательным
ether broadcast                                  Проверяет, является ли
                                                 ARP-пакет широковещательным
----------

SSH:
----------
ssh -p port user@*.*.*.*                         Подключение по SSH
scp -P port user@*.*.*.*:/dir/file ./            Копирование файла с удаленного
                                                 сервера по SSH
scp -P port ./file user@*.*.*.*:/dir/            Копирование файла на удаленный
                                                 сервер по SSH
----------
SSH Multiplexing:
----------
ControlMaster auto
ControlPath /tmp/ssh_mux_%h_%p_%r
ControlPersist 4h
----------
SSH Debug:
----------
Для сервера:
sudo /usr/sbin/sshd -ddd (количество d - уровень дебага)
Для клиента:
ssh admin@10.10.10.10 -vvv (количество v - уровень дебага)
----------
SSH Тонель:
----------
/usr/bin/ssh -f -N -R 555:localhost:22 -p 666 admin@10.10.10.10
----------

tar:
----------
tar -cvf archive.tar ./dir                       Создание архива  archive.tar
                                                 c папкой ./dir
tar -cvzf archive.tar.gz ./dir                   Создание архива archive.tar.gz
                                                 с папкой ./dir
tar -cvjf archive.tar.bz2 ./dir                  Создание архива archive.tar.bz2
                                                 с папкой ./dir
tar -cvJf archive.tar.xz ./dir                   Создание архива archive.tar.xz
                                                 с папкой ./dir
tar -xvf ./archive.tar -C ./dir                  Извлечение архива
                                                 ./archive.tar в ./dir
tar -tf archive.tar                              Содержимое архива archive.tar
----------

git:
----------
git init                                         Создание репозитория
git status                                       Вывод состояния репозитория
git log                                          Вывод информации о коммитах
git add files                                    Добавление изменений
                                                 files
git rm files                                     Удаление файлов изменений files
git commit -m "comment"                          Создание коммита
                                                 с коментарием comment
git remote add origin URL                        Добавление удаленного
                                                 репозитория origin
git push RepName master:master                   Создание Push
                                                 репозитория RepName
git remote -v                                    Список подключенных
                                                 удаленных репозиториев
git clone URL                                    Клонирование удаленного
                                                 репозитория
git diff                                         Сравнение веток, комитов
git reset                                        Возврат к определенному комиту
git branch newBrunch                             Создание ветки newBrunch
git branch -d newBranch                          Удаление ветки newBranch
git branch -D newBranch                          Удаление ветки newBranch
git checkout newBranch                           Переход на ветку newBranch
git merge newBranch                              Слияние текущей ветки
                                                 с newBranch
----------

tmux:
----------
Prefix+o                                         Переход в следующее окно
Prifix+Alt+2                                     Закрытие окна
Prefix+Alt+4                                     Переход в новое окно
Prifix+p(n)                                      Следующая (предыдущая) вкладка
Prefix+c                                         Переход в новую вкладку
Prefix+z                                         Разворачивание окна
CTRL+a                                           Переход в начало строки
Prefix+:                                         Командная строка TMUX
setw synchronize-panes on (off)                  Включить (выключить) синхронный
                                                 ввод во все панели в текущей
                                                 вкладке
----------

vim основное:
----------
h, j, k, l                                       Перемешение
CTRL+U, CTRL+D                                   Страница вверх, вниз
w, b                                             Перемещение по словам
H, L                                             Перемещение в начало и
                                                 в конец экрана
:2                                               Переход ко 2 строке

:w [fname]                                       Сохранение изменений
:wa                                              Сохранение изменений
                                                 во всех файлах
:q                                               Выход из редактора
:q!                                              Выход из редактора, без
                                                 сохранений изменений

i                                                Режим редактирования
v                                                Режим выделения
ESC                                              Режим просмотра
y                                                Копирование
p                                                Вставка
CTL+SHIFT+v                                      Вставка из буфера
dd                                               Удаление строки

v+hjkl                                           Выделить текст
SHIFT+v                                          Выделение строки
CTR+v                                            Выделить прямоугольник

u, :u[ndo]                                       Отмена предыдущего
                                                 действия
CTR-r, :red[o]                                   Отмена отмены предыдущего
                                                 действия

zc                                               Свернуть блок
zo                                               Развернуть блок

----------

vim полный:
----------
I                                                Добавить в начало строки
a                                                Режим добавления
A                                                Добавить в конец строки
o                                                Добавить строку сразу за
                                                 текущей
O                                                Добавить строку перед текущей
R                                                Написать поверх имеющегося
                                                 текста
cc                                               Удалить и начать
                                                 редактировать
yy                                               Копировать строки
p                                                Вставить из буфера обмена
<n>d                                             Удалить n+1 строку
<n>y                                             Скопировать n+1 строку
DEL                                              Удалить следующий символ
:<n>                                             Перейти на строку n
%                                                Перейти к парной скобке
:e **/filename.c                                 Редактировать файл
                                                 (с поиском по имени)
:color <name>                                    Выбор цветовой схемы. Цветовые
                                                 схемы:
                                                 /usr/local/share/vim/vim72/colors/*.vim
:pwd                                             Текущий каталог
:cd [path]                                       Перейти в другой каталог
:!команда                                        Выполнить команду - man, git,
                                                 и так далее стрелками вверх
                                                 и вниз можно автодополнять
                                                 команды и искать по истории
CTR+p или CTR+n                                  Автоматическое дополнение
                                                 текста
                                                 (в режиме редактирования)
CTR+r,=,<expr>                                   Вставить выражение,
                                                 например 5*2 - 3
                                                 (в режиме редактирования)
CTR+u, CTR+d                                     Page Up / Page Down
CTR+y, CTR+e                                     Перемотка вверх/вниз
                                                 без движения курсора
:syntax on                                       Включить подсветку
:syntax off                                      Выключить подсветку
                                                 (по умолчанию)
:set wrap                                        Разрешить word wrap
                                                 (по умолчанию)
:set nowrap                                      Запретить word wrap
:ha[rdcopy]                                      Распечатать документ
:set printoptions=duplex:off                     Отключить двустороннюю печать
zM                                               Закрыть все блоки
zR                                               Открыть все блоки
za                                               Инвертирование
zf                                               См :set foldmethod=manual
:set foldenable                                  Включить свoрачивание
:set foldmethod=syntax                           Сворачивание на основе
                                                 синтаксиса
:set foldmethod=indent                           Сворачивание на основе отступов
:set foldmethod=manual                           Сворачивание,
                                                 Выделить участок с помощью v
                                                 и zf
:set foldmethod=marker                           Сворачивание на основе
                                                 маркеров в тексте
:set foldmarker=bigin,end                        Задать маркеры начала
                                                 и конца блока
ma                                               Установить локальный маркер a
mB                                               Установить глобальный маркер B
`c                                               Перейти к локальному маркеру c
`0                                               Вернуться на позицию,
                                                 на которой закончили работу
                                                 при закрытии vim
:marks                                           Просмотреть маркеры
mksession file.session                           Сохранить текущую сессию
source file.session                              Восстановить ранее сохраненную
                                                 сессию
qa                                               Записать макрос с именем a

В режиме записи макроса:
q                                                Закончить запись
@a                                               Выполнить макрос с именем a
@@                                               Повторить последний макрос
"ayy                                             Скопировать строку в регистр a
"bdd                                             Вырезать строку и поместить в
                                                 регистр b
"С2d                                             Вырезать три строчки и дописать
                                                 в конец регистра C
:reg [name1][name2][...]                         Просмотреть содержимое
                                                 регистров
d                                                Удалить
gu                                               К нижнему регистру
gU                                               К верхнему регистру
[#]>                                             Сдвинуть выделенное вправо
[#]<                                             Сдвинуть выделенное влево
[#]>>                                            Сдвинуть строку вправо
[#]<<                                            Сдвинуть строку влево
set tabstop=#                                    Использовать для табуляции
                                                 # пробелов
set shiftwidth=#                                 Использовать в командах отступа
                                                 # пробелов
set [no]expandtab                                Заменить табуляцию на
                                                 соответствующее число пробелов
/Выражение                                       Поиск выражения в файле
\cВыражение                                      Поиск без учета регистра
n                                                Следующее совпадение
N                                                Предыдущее совпадение
:vimgrep /EXPR/ **/*.c                           Поиск по регулярному выражению
:copen                                           Показать все найденные места
:close                                           Скрыть все найденные места
:cn                                              Перейти к следующему результату
:cp                                              Перейти к предыдущему результату
:set number                                      Включить нумерацию строк
:set nonumber                                    Отключить нумерацию строк
:tabnew [fname]                                  Создать таб
:tabs                                            Вывести список табов
:tabn                                            Следующий таб
:tabp                                            Предыдущий таб
<n>gt                                            Перейти на таб #n
gt                                               Следующий таб
gT                                               Предыдущий таб
:tabm +1                                         Переместить таб вперед на
                                                 одну позицию
:tabm -1                                         Переместить таб назад на
                                                 одну позицию
:tabm 2                                          Переместить таб на заданную
                                                 позицию
                                                 (нумерация начинается с нуля)
:split                                           Горизонтальное разбиение
:vsplit                                          Вертикальное разбиение

Ctr+W, затем
  с                                              Закрыть окно
  +-                                             Изменить высоту текущего окна
  <>                                             Изменить ширину текущего окна
  =                                              Установить равный размер окон
  hjkl или стрелочки                             Перемещение между окнами
:set spell spelllang=ru,en                       Включить проверку орфографии
:set nospell                                     Выключить проверку орфографии
]s                                               Следующее слово с ошибкой
[s                                               Предыдущее слово с ошибкой
z=                                               Замить слова на альтернативу
                                                 из списка
zg                                               Good word
zw                                               Wrong word
zG                                               Ignore word
w ++enc=<имя кодировки>                          Сохранить файл
                                                 в новой кодировке
set fileencodings=utf-8,koi8-r                   Список автоматически
                                                 определяемых кодировок в
                                                 порядке убывания приоритета
:set [no]wildmenu                                При автодополнении в командной
                                                 строке над ней выводятся
                                                 возможные варианты
:set list                                        Отображать табуляцию и
                                                 переводы строк
q:                                               История команд
.                                                Повторить последнюю команду
----------

Изменение размеров изображеия:
----------
convert -resize 512x image.jpg image.png
convert -resize x512 image.jpg image.png
----------

Выполнить сканирование изображения:
----------
scascanimage —device `hpaio:/usb/Deskjet_1510_series?serial=CN35O1DKRW05YR' —format=tiff >test.tiffnimage -L
----------

Read mp3 tags in shell:
----------
sudo apt-get install ffmpeg
ffprobe file.mp3
----------
sudo apt-get install mp3info
mp3info -p %a file.mp3
----------

Delete icloud files:
----------
find . -type f -exec brctl evict {} \;
----------





НАСТРОЙКА:
Настройка NAT:
----------
Проверить значение "cat /proc/sys/net/ipv4/ip_forward" на соответствие "1".
Установить значение "ipv4.ip_forward" равным "1" в файле "/etc/sysctl.conf".
Выполнить команду
"sudo iptables -t nat -A POSTROUTING -o DEVICE_WITH_NET -j MASQUERADE".
----------

Настройка wg:
----------
Сервер:
/etc/wireguard/wg0.conf
[Interface]
Address = 192.168.0.1/24
ListenPort = 443
PrivateKey = SERVER_PRIVATE_KEY

[Peer]
AllowedIPs = 192.168.0.2/24
PublicKey = CLIENT_PUBLIC_KEY

Клиент:
/etc/wireguard/wg0.conf
[Interface]
Address = 192.168.0.2/24
PrivateKey = CLIENT_PRIVATE_KEY
DNS = 8.8.8.8

[Peer]
PublicKey = SERVER_PUBLIC_KEY
AllowedIPs = 0.0.0.0/0
Endpoint = 10.10.10.10:443
PersistentKeepalive = 25

Затем:
systemctl restart wg-quick@wg0.service
На сервере настроить NAT в iptables и включить форвардинг.
----------
Создание загрузочной флешки:
----------
dd bs=4M if=path/to/archlinux-version-x86_64.iso of=/dev/sdx conv=fsync oflag=direct status=progress
----------





ПРОБЛЕМЫ:
Проблемы с wireshark:
----------
sudo chmod 755 /usr/bin/dumpcap
----------
Проблемы с wireshark на macOS:
----------
cd /dev
sudo chown user_name:admin bp*
----------

